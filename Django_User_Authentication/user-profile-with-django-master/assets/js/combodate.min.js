'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a};(function(a){var b=function(c,g){return this.$element=a(c),this.$element.is('input')?void(this.options=a.extend({},a.fn.combodate.defaults,g,this.$element.data()),this.init()):void a.error('Combodate should be applied to INPUT element')};b.prototype={constructor:b,init:function init(){this.map={day:['D','date'],month:['M','month'],year:['Y','year'],hour:['[Hh]','hours'],minute:['m','minutes'],second:['s','seconds'],ampm:['[Aa]','']},this.$widget=a('<span class="combodate"></span>').html(this.getTemplate()),this.initCombos(),this.$widget.on('change','select',a.proxy(function(c){this.$element.val(this.getValue()).change(),this.options.smartDays&&(a(c.target).is('.month')||a(c.target).is('.year'))&&this.fillCombo('day')},this)),this.$widget.find('select').css('width','auto'),this.$element.hide().after(this.$widget),this.setValue(this.$element.val()||this.options.value)},getTemplate:function getTemplate(){var c=this.options.template,g=this.options.customClass;return a.each(this.map,function(h,j){j=j[0];var l=new RegExp(j+'+'),m=1<j.length?j.substring(1,2):j;c=c.replace(l,'{'+m+'}')}),c=c.replace(/ /g,'&nbsp;'),a.each(this.map,function(h,j){j=j[0];var l=1<j.length?j.substring(1,2):j;c=c.replace('{'+l+'}','<select class="'+h+' '+g+'"></select>')}),c},initCombos:function initCombos(){for(var c in this.map){var g=this.$widget.find('.'+c);this['$'+c]=g.length?g:null,this.fillCombo(c)}},fillCombo:function fillCombo(c){var g=this['$'+c];if(g){var h='fill'+c.charAt(0).toUpperCase()+c.slice(1),j=this[h](),l=g.val();g.empty();for(var m=0;m<j.length;m++)g.append('<option value="'+j[m][0]+'">'+j[m][1]+'</option>');g.val(l)}},fillCommon:function fillCommon(c){var h,g=[];if('name'===this.options.firstItem){h=moment.relativeTime||moment.langData()._relativeTime;var j='function'==typeof h[c]?h[c](1,!0,c,!1):h[c];j=j.split(' ').reverse()[0],g.push(['',j])}else'empty'===this.options.firstItem&&g.push(['','']);return g},fillDay:function fillDay(){var g,h,c=this.fillCommon('d'),j=-1!==this.options.template.indexOf('DD'),l=31;if(this.options.smartDays&&this.$month&&this.$year){var m=parseInt(this.$month.val(),10),n=parseInt(this.$year.val(),10);isNaN(m)||isNaN(n)||(l=moment([n,m]).daysInMonth())}for(h=1;h<=l;h++)g=j?this.leadZero(h):h,c.push([h,g]);return c},fillMonth:function fillMonth(){var g,h,c=this.fillCommon('M'),j=-1!==this.options.template.indexOf('MMMM'),l=-1!==this.options.template.indexOf('MMM'),m=-1!==this.options.template.indexOf('MM');for(h=0;11>=h;h++)g=j?moment().date(1).month(h).format('MMMM'):l?moment().date(1).month(h).format('MMM'):m?this.leadZero(h+1):h+1,c.push([h,g]);return c},fillYear:function fillYear(){var g,h,c=[],j=-1!==this.options.template.indexOf('YYYY');for(h=this.options.maxYear;h>=this.options.minYear;h--)g=j?h:(h+'').substring(2),c[this.options.yearDescending?'push':'unshift']([h,g]);return c=this.fillCommon('y').concat(c),c},fillHour:function fillHour(){var g,h,c=this.fillCommon('h'),j=-1!==this.options.template.indexOf('h'),l=-1!==this.options.template.indexOf('H'),m=-1!==this.options.template.toLowerCase().indexOf('hh'),n=j?1:0,o=j?12:23;for(h=n;h<=o;h++)g=m?this.leadZero(h):h,c.push([h,g]);return c},fillMinute:function fillMinute(){var g,h,c=this.fillCommon('m'),j=-1!==this.options.template.indexOf('mm');for(h=0;59>=h;h+=this.options.minuteStep)g=j?this.leadZero(h):h,c.push([h,g]);return c},fillSecond:function fillSecond(){var g,h,c=this.fillCommon('s'),j=-1!==this.options.template.indexOf('ss');for(h=0;59>=h;h+=this.options.secondStep)g=j?this.leadZero(h):h,c.push([h,g]);return c},fillAmpm:function fillAmpm(){var c=-1!==this.options.template.indexOf('a'),g=-1!==this.options.template.indexOf('A'),h=[['am',c?'am':'AM'],['pm',c?'pm':'PM']];return h},getValue:function getValue(c){var g,h={},j=this,l=!1;return(a.each(this.map,function(m){if('ampm'!==m){var o='day'===m?1:0;if(h[m]=j['$'+m]?parseInt(j['$'+m].val(),10):o,isNaN(h[m]))return l=!0,!1}}),l)?'':(this.$ampm&&(12===h.hour?h.hour='am'===this.$ampm.val()?0:12:h.hour='am'===this.$ampm.val()?h.hour:h.hour+12),g=moment([h.year,h.month,h.day,h.hour,h.minute,h.second]),this.highlight(g),c=void 0===c?this.options.format:c,null===c?g.isValid()?g:null:g.isValid()?g.format(c):'')},setValue:function setValue(c){function g(m,n){var o={};return m.children('option').each(function(p,q){var t,s=a(q).attr('value');''===s||(t=Math.abs(s-n),('undefined'==typeof o.distance||t<o.distance)&&(o={value:s,distance:t}))}),o.value}if(c){var h='string'==typeof c?moment(c,this.options.format,!0):moment(c),j=this,l={};h.isValid()&&(a.each(this.map,function(m,n){'ampm'===m||(l[m]=h[n[1]]())}),this.$ampm&&(12<=l.hour?(l.ampm='pm',12<l.hour&&(l.hour-=12)):(l.ampm='am',0===l.hour&&(l.hour=12))),a.each(l,function(m,n){j['$'+m]&&('minute'===m&&1<j.options.minuteStep&&j.options.roundTime&&(n=g(j['$'+m],n)),'second'===m&&1<j.options.secondStep&&j.options.roundTime&&(n=g(j['$'+m],n)),j['$'+m].val(n))}),this.options.smartDays&&this.fillCombo('day'),this.$element.val(h.format(this.options.format)).change())}},highlight:function highlight(c){c.isValid()?this.options.errorClass?this.$widget.removeClass(this.options.errorClass):this.$widget.find('select').css('border-color',this.borderColor):this.options.errorClass?this.$widget.addClass(this.options.errorClass):(!this.borderColor&&(this.borderColor=this.$widget.find('select').css('border-color')),this.$widget.find('select').css('border-color','red'))},leadZero:function leadZero(c){return 9>=c?'0'+c:c},destroy:function destroy(){this.$widget.remove(),this.$element.removeData('combodate').show()}},a.fn.combodate=function(c){var g,h=Array.apply(null,arguments);return h.shift(),'getValue'===c&&this.length&&(g=this.eq(0).data('combodate'))?g.getValue.apply(g,h):this.each(function(){var j=a(this),l=j.data('combodate'),m='object'==('undefined'==typeof c?'undefined':_typeof(c))&&c;l||j.data('combodate',l=new b(this,m)),'string'==typeof c&&'function'==typeof l[c]&&l[c].apply(l,h)})},a.fn.combodate.defaults={format:'DD-MM-YYYY HH:mm',template:'D / MMM / YYYY   H : mm',value:null,minYear:1970,maxYear:2015,yearDescending:!0,minuteStep:5,secondStep:1,firstItem:'empty',errorClass:null,customClass:'',roundTime:!0,smartDays:!1}})(window.jQuery);